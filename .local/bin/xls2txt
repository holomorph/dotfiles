#!/bin/bash
# xls2txt --- format Excel spreadsheets into plaintext tables

f="$1"

if [[ "$f" = *.xlsx ]]; then
    xlsx2csv "$f" | column -ts'	'
else
    # for everything else, use xls2csv
    sed -rf - <<EOF <(xls2csv "$f" 2>/dev/null) | column -ts'	'
s/^,*$//
s/,,/,"",/g
s/,,/,"",/g
s/^,/"",/
s/^"//
s/,*$//
s/"$//
s/","/	/g
EOF
fi
